!function(t){function e(e){for(var n,o,i=e[0],r=e[1],u=e[2],l=0,d=[];l<i.length;l++)o=i[l],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);for(h&&h(e);d.length;)d.shift()();return c.push.apply(c,u||[]),a()}function a(){for(var t,e=0;e<c.length;e++){for(var a=c[e],n=!0,i=1;i<a.length;i++){var r=a[i];0!==s[r]&&(n=!1)}n&&(c.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},s={0:0},c=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var i=window.webpackJsonp=window.webpackJsonp||[],r=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var h=r;c.push([2,1]),a()}([,,function(t,e,a){t.exports=a(3)},function(t,e,a){"use strict";a.r(e);a(4),a(8);window._genesys={}},function(t,e,a){"use strict";(function(t){var e=a(0),n=a.n(e),s=a(1),c=t,o=chatData.is_production,i=decodeURIComponent(window.location.search);-1!==i.indexOf("dir=in")&&-1!==i.indexOf("attachedData=update successfull")&&(n.a.set("gcLoginButtonState",1),window.location.href=chatData.home_url);var r="",u="",h="",l="",d="",p="",g="",f="",b="",w="",m="",v=Object(s.isUndefined)(n.a.get("nuheChatMode"))?0:parseInt(n.a.get("nuheChatMode")),y=Object(s.isUndefined)(n.a.get("nuheChatTopicSelection"))?"0":n.a.get("nuheChatTopicSelection"),j="TESTISIVU_TESTI",C="https://asiointi.hel.fi/chat/sote/custom/chat-testisivu-fi.json";o&&(j=1===v?"NUORTEN_SOS":"NUORTEN_TER",C="https://asiointi.hel.fi/chat/sote/custom/chat-nuortenchat-fi.json");var O='<div class="chat-controls">\n                            <button type="button" class="gwc-chat-control-close chat-controls__btn--hidden" id="gwc-close-chat-btn"></button>\n                            <button type="button" class="chat-controls__btn" id="js-close-chat-box" aria-label="'.concat(chatData.close_chat_text,'">')+'<span aria-hidden="true" class="hds-icon hds-icon--cross-circle hds-icon--size-s"></span>\n                            </button>\n                         </div>',S='<button disabled type="button" class="gwc-send-message hds-button hds-button--primary" aria-label="'.concat(chatData.send_message,'">')+'<span aria-hidden="true" class="hds-icon hds-icon--arrow-right hds-icon--size-m"></span>\n                        </button>',k='<span class="chat-status-indicator">\n                            <span aria-hidden="true" class="hds-icon hds-icon--speechbubble-text hds-icon--size-m">\n                            </span>\n                        </span>\n                        <span id="chat-title" class="gwc-chat-title">\n                            '.concat("Nuorten chat","\n                        </span>");function x(){window._genesys={onReady:[],chat:{registration:!1,localization:C,onReady:[],ui:{onBeforeChat:function(){setTimeout((function(){!function(){c(".gwc-chat-head").find(".gwc-chat-title").replaceWith(k),c(".gwc-chat-window-controls").remove(),c(".gwc-chat-head").append(O),c(".gwc-chat-branding").remove(),c(".gwc-chat-body").prepend('<a class="chat-auth-btn" href="#" aria-label="Tunnistaudu tästä, siirryt tunnistautumispalveluun">Tunnistaudu tästä</a>'),c(".gwc-chat-message-form").append(S),c(".gwc-chat-message-input").attr({placeholder:"Kirjoita viesti...",tabIndex:"0",ariaLabel:"Uusi viesti",onInput:"this.parentNode.dataset.replicatedValue = this.value"}).wrap('<div class="grow-wrap"></div>'),c(".gwc-chat-systemMessage").removeClass("gwc-chat-systemMessage").addClass("gwc-chat-message--system").find(".gwc-chat-message-text").attr("tabindex",0).prepend('<span class="sr-only">Järjestelmä sanoo : </span>'),c(".gwc-chat-embedded-window").attr({"aria-label":"Nuorten chat",role:"region"}),c(".gwc-persistent-chat-messages").attr("aria-live","polite");var t=n.a.get("gcLoginButtonState"),e=c(".chat-auth-btn"),a=c(".gwc-chat-message-container");"1"===t?(e.hide(),a.css("top","110px")):(e.show(),a.css("top","165px"))}()}),0),window._genesys.chat.onReady.push((function(t){t.restoreChat({serverUrl:"https://asiointi.hel.fi/chat/sote/cobrowse",registration:function(t){t({service:j,Language:"FI",chattopic:y})}}).done((function(t){t.setUserData({service:j,Language:"FI",chattopic:y}),c(".gwc-chat-message-input").on("keyup",(function(){c(this).val().length?c(".gwc-send-message").prop("disabled",!1):c(".gwc-send-message").prop("disabled",!0)})),c(document).on("click",".gwc-send-message",(function(){var e=c(".gwc-chat-message-input").val();t.sendMessage(e),c(".gwc-chat-message-input").val("").focus()})),t.onMessageReceived((function(t){c(".gwc-chat-message-time").last().html((function(){var t=c(this).html().slice(1,-4);c(this).html(t)}));var e="",a="",n="sanoo";1===t.party.id?(e="Sinä",a="user",n="sanot"):2===t.party.id?(e="Järjestelmä",a="system"):(e="Sosiaali- ja terveysalan ammattilainen",a="agent"),c(".gwc-chat-message-text").last().addClass("".concat(a,"-message")).attr("tabindex",0),c(".gwc-chat-message-author").last().remove(),c(".".concat(a,"-message")).last().prepend('<span class="sr-only">'.concat(e," ").concat(n," : </span>")).closest(".gwc-chat-message").addClass("gwc-chat-message--".concat(a)),c(".gwc-chat-message-time").last().appendTo(c(".".concat(a,"-message")).last()),c(".gwc-chat-message-time").attr({"aria-atomic":!0})})),t.onSessionEnded((function(){c(".gwc-chat-message-input").attr("disabled","true"),c(".gwc-chat-btn").remove()}))})).fail((function(t){alert(t.description)}))}))}}},cobrowse:!1}}function _(){l=c(".gwc-chat-embedded-window"),r=c("#js-nuhe-open-chat"),u=r.parent(),l.length||u.show(),(h=c(".gcb-startChat")).attr("tabindex","0"),h.attr("onkeypress","onEnter(event, this)"),h.attr("role","button")}function T(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c.ajax({url:chatData.chat_status_url,success:function(e){if(t&&(_(),M()),!1!==e&&e!==g){g=e;var a=c("body");a.hasClass("chat-open")||a.hasClass("chat-closed")?a.hasClass("chat-open")?a.addClass("chat-closed").removeClass("chat-open"):a.addClass("chat-open").removeClass("chat-closed"):a.addClass("open"===g?"chat-open":"chat-closed")}}})}function D(t){return t.filter((function(t,e){return"none"!==c(e).css("display")&&!c(e).is(":disabled")}))}function M(){r.click((function(){r.attr("aria-expanded",!0),u.hide(),l.length?l.show():(f.show().focus().attr("aria-hidden",!1),f.focus())})),w.on("keyup click",(function(t){"keyup"===t.type&&13!==t.keyCode&&32!==t.keyCode||(f.hide().attr("aria-hidden",!0),u.show(),r.attr("aria-expanded",!1))})),m.click((function(){f.hide(),v=c(this).data("chatMode"),o&&(j=1===v?"NUORTEN_SOS":"NUORTEN_TER"),y=c(this).data("topic"),n.a.set("nuheChatTopicSelection",y),n.a.set("nuheChatMode",v),h.click()})),c(document).on("click","#js-close-chat-box",(function(){if(confirm("Oletko varma, että haluat lopettaa chat-keskustelun?")){c("#gwc-close-chat-btn").click();["gcCurrentSession","nuheChatMode","nuheChatTopicSelection","gcLoginButtonState","gcReturnSessionId"].forEach((function(t){n.a.remove(t)})),window.location=window.location.href}})),c(document).on("click",".chat-auth-btn",(function(t){var e;t.preventDefault(),e=n.a.get("gcCurrentSession"),(Object(s.isEmpty)(e)?(alert("Virhe, ei voida tunnistaa käyttäjää, koska chat-keskustelu ei ole auki."),!1):(n.a.set("gcReturnSessionId",e),n.a.set("gcReturnUrl",window.location.href),n.a.set("gcAlternativeReturnUrl",window.location.href),!0))&&function(){var t=n.a.get("gcCurrentSession");if(!Object(s.isEmpty)(t)){var e=function(t){var e=t,a=e.indexOf("_"),n=e.substring(0,a),s=n.length-16;return n.substring(s,n.Length)}(t),a=window.location.href,c="https://asiointi.hel.fi/chat/tunnistus/Shibboleth.sso/KAPALogin?";c+="target=",c+="https://asiointi.hel.fi/chat/tunnistus/MagicPage3/ReturnProcessor",c+="%3ForigPage%3D".concat(a,"?dir%3Din%26gcLoginButtonState%3D1%26errcode%3d0"),c+="%26interactionId%3D".concat(e,"%26method%3D1%26version%3D2"),window.location=c}}()}))}c("body").on("DOMSubtreeModified",(function(){c(".gcb-startBtnsContainer").length&&(c(this).off("DOMSubtreeModified"),T(!0))})),c(document).ready((function(){f=c(".nuhe-chat-lobby"),b=D(f.find('span[role="button"], button, a, textarea')),w=c("#js-close-lobby-btn"),m=c(".chat-topic-btn"),setInterval((function(){T()}),3e4),function(){var t="genesys-js";if(!c("#".concat(t)).length){var e=c("script")[0],a='<script id="'.concat(t,'" src="').concat("https://asiointi.hel.fi/chat/sote/cobrowse/js/gcb.min.js",'" data-gcb-url="').concat("https://asiointi.hel.fi/chat/sote/cobrowse",'"><\/script>');c(a).insertBefore(e)}}(),x()})),c(document).on("keydown",(function(t){return function(t){if(9===t.keyCode){var e=!(Object(s.isEmpty)(f)||!f.is(":visible"));Object(s.isEmpty)(d)&&(d=c(".gwc-chat")),p=D(d.find('div[role="button"], button, a, textarea'));var a=!(!d.length||!d.is(":visible"));if(e||a){var n=c(t.target).closest(".nuhe-chat-lobby")[0],o=c(t.target).closest(".gwc-chat")[0],i=f.is(":visible")?b:p,r=i[0],u=i[i.length-1];Object(s.isUndefined)(n)&&Object(s.isUndefined)(o)&&(t.preventDefault(),i[0].focus()),t.shiftKey&&document.activeElement===r?(t.preventDefault(),u.focus()):t.shiftKey||document.activeElement!==u||(t.preventDefault(),r.focus())}}}(t)}))}).call(this,a(5))},function(t,e){t.exports=jQuery},,,function(t,e,a){}]);